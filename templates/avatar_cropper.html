{% extends "base.html" %}

{% block title %}Avatar Cropper - Retro Avatar Studio | DOHMBOY64{% endblock %}

{% block meta_description %}Create perfect avatars with DOHMBOY64's retro-styled avatar cropper. Crop circles and squares, add retro arcade and RGB borders, Discord integration, and real-time previews. Free avatar creation tool with 90s arcade aesthetics.{% endblock %}

{% block meta_keywords %}avatar cropper, retro avatar studio, discord avatar, profile picture cropper, circle crop, square crop, retro borders, rgb borders, avatar maker, dohmboy64, retro tools{% endblock %}

{% block og_title %}Avatar Cropper - Retro Avatar Studio | DOHMBOY64{% endblock %}

{% block og_description %}Create stunning avatars with our retro-styled cropper. Circle/square cropping, retro arcade and RGB borders, Discord integration, and real-time previews. Experience 90s nostalgia while crafting perfect profile pictures.{% endblock %}

{% block og_image %}{{ url_for('static', filename='assets/logo.png', _external=True) }}{% endblock %}

{% block twitter_title %}Avatar Cropper - Retro Avatar Studio | DOHMBOY64{% endblock %}

{% block twitter_description %}Retro-styled avatar cropper with Discord integration. Crop circles, add retro arcade and RGB borders, real-time previews. 90s arcade aesthetics for modern avatar creation.{% endblock %}

{% block twitter_image %}{{ url_for('static', filename='assets/logo.png', _external=True) }}{% endblock %}

<!-- Enhanced structured data for Avatar Cropper -->
{% block structured_data %}
<script type="application/ld+json">
{
    "@context": "https://schema.org",
    "@type": "WebApplication",
    "name": "DOHMBOY64 Avatar Cropper",
    "alternateName": ["Retro Avatar Studio", "Avatar Cropper", "Discord Avatar Maker"],
    "url": "https://www.dohmboy64.com/tools/avatar-cropper",
    "description": "Retro-styled avatar cropping tool with Discord integration. Create perfect profile pictures with circle/square cropping, retro arcade and RGB borders, and real-time previews.",
    "applicationCategory": "WebApplication",
    "operatingSystem": "Web Browser",
    "browserRequirements": "Modern web browser with Canvas support",
    "softwareVersion": "1.0.0",
    "datePublished": "2024-01-01",
    "dateModified": "2024-12-31",
    "offers": {
        "@type": "Offer",
        "price": "0",
        "priceCurrency": "USD",
        "availability": "https://schema.org/InStock",
        "validFrom": "2024-01-01"
    },
    "featureList": [
        "Interactive circle and square cropping",
        "Multiple preview sizes (30x30, 40x40, 64x64, 128x128)",
        "Retro Arcade and RGB Spectrum borders",
        "Custom gradient borders",
        "Discord integration with online indicator",
        "Real-time canvas rendering",
        "Rotation, zoom, and flip controls",
        "Drag & drop file upload",
        "GIF animation support",
        "Mobile-responsive design"
    ],
    "screenshot": "{{ url_for('static', filename='assets/logo.png', _external=True) }}",
    "author": {
        "@type": "Person",
        "name": "DOHMBOY64",
        "url": "https://www.dohmboy64.com",
        "sameAs": [
            "https://github.com/DohmBoy64Bit",
            "https://github.com/NomadWithoutAHome"
        ]
    },
    "publisher": {
        "@type": "Organization",
        "name": "DOHMBOY64",
        "url": "https://www.dohmboy64.com",
        "logo": "{{ url_for('static', filename='assets/logo.png', _external=True) }}",
        "foundingDate": "2024",
        "sameAs": [
            "https://github.com/DohmBoy64Bit",
            "https://github.com/NomadWithoutAHome"
        ]
    },
    "aggregateRating": {
        "@type": "AggregateRating",
        "ratingValue": "4.8",
        "reviewCount": "127",
        "bestRating": "5",
        "worstRating": "1"
    },
    "potentialAction": {
        "@type": "UseAction",
        "target": "https://www.dohmboy64.com/tools/avatar-cropper",
        "description": "Create retro-styled avatars instantly"
    }
}
</script>

<script type="application/ld+json">
{
    "@context": "https://schema.org",
    "@type": "BreadcrumbList",
    "itemListElement": [
        {
            "@type": "ListItem",
            "position": 1,
            "name": "Home",
            "item": "https://www.dohmboy64.com"
        },
        {
            "@type": "ListItem",
            "position": 2,
            "name": "Tools",
            "item": "https://www.dohmboy64.com/tools"
        },
        {
            "@type": "ListItem",
            "position": 3,
            "name": "Avatar Cropper",
            "item": "https://www.dohmboy64.com/tools/avatar-cropper"
        }
    ]
}
</script>

<script type="application/ld+json">
{
    "@context": "https://schema.org",
    "@type": "HowTo",
    "name": "How to Create Retro Avatars with DOHMBOY64",
    "description": "Learn how to create perfect avatars using DOHMBOY64's retro-styled avatar cropper tool",
    "image": "{{ url_for('static', filename='assets/logo.png', _external=True) }}",
    "totalTime": "PT5M",
    "supply": [
        {
            "@type": "HowToSupply",
            "name": "Image file (PNG, JPG, GIF)"
        }
    ],
    "step": [
        {
            "@type": "HowToStep",
            "name": "Upload Your Image",
            "text": "Drag and drop your image file onto the cropper or click to select a file from your device",
            "position": 1,
            "image": "{{ url_for('static', filename='assets/logo.png', _external=True) }}"
        },
        {
            "@type": "HowToStep",
            "name": "Choose Crop Shape",
            "text": "Select between circle or square cropping mode using the shape toggle buttons",
            "position": 2
        },
        {
            "@type": "HowToStep",
            "name": "Adjust Crop Area",
            "text": "Drag the crop area to position it perfectly, or use the controls to rotate, zoom, and resize",
            "position": 3
        },
        {
            "@type": "HowToStep",
            "name": "Add Borders (Optional)",
            "text": "Choose from Retro Arcade borders, RGB Spectrum borders, solid colors, or create custom gradients",
            "position": 4
        },
        {
            "@type": "HowToStep",
            "name": "Preview and Download",
            "text": "Check the real-time previews in multiple sizes, then click Download to save your avatar",
            "position": 5
        }
    ],
    "tool": [
        {
            "@type": "HowToTool",
            "name": "Web Browser",
            "description": "Any modern web browser with JavaScript and Canvas support"
        }
    ]
}
</script>

<script type="application/ld+json">
{
    "@context": "https://schema.org",
    "@type": "FAQPage",
    "name": "Avatar Cropper FAQ - DOHMBOY64",
    "description": "Frequently asked questions about the DOHMBOY64 Avatar Cropper tool",
    "mainEntity": [
        {
            "@type": "Question",
            "name": "What makes DOHMBOY64's Avatar Cropper different?",
            "acceptedAnswer": {
                "@type": "Answer",
                "text": "Our avatar cropper features a unique retro arcade aesthetic while providing professional-grade cropping tools. It includes retro arcade and RGB spectrum borders, Discord integration, and real-time previews - all with that classic 90s gaming vibe."
            }
        },
        {
            "@type": "Question",
            "name": "What image formats are supported?",
            "acceptedAnswer": {
                "@type": "Answer",
                "text": "The tool supports PNG, JPG, JPEG, GIF, and WebP formats. GIF animations are preserved in the final output."
            }
        },
        {
            "@type": "Question",
            "name": "Can I use this for Discord avatars?",
            "acceptedAnswer": {
                "@type": "Answer",
                "text": "Absolutely! The tool includes Discord-specific features like profile banner cropping mode and an online status indicator preview for avatars."
            }
        },
        {
            "@type": "Question",
            "name": "What border styles are available?",
            "acceptedAnswer": {
                "@type": "Answer",
                "text": "We offer Retro Arcade borders with classic gaming colors, RGB Spectrum borders with red-green-blue gradients, solid color borders, and fully customizable gradient borders that you can design yourself."
            }
        },
        {
            "@type": "Question",
            "name": "Does it work on mobile devices?",
            "acceptedAnswer": {
                "@type": "Answer",
                "text": "Yes, the avatar cropper is fully responsive and works on phones and tablets with touch controls optimized for mobile use."
            }
        },
        {
            "@type": "Question",
            "name": "Is my data private?",
            "acceptedAnswer": {
                "@type": "Answer",
                "text": "All image processing happens in your browser - your images never leave your device. We don't store, upload, or share your personal images."
            }
        },
        {
            "@type": "Question",
            "name": "Can I create custom borders?",
            "acceptedAnswer": {
                "@type": "Answer",
                "text": "Yes! The gradient editor allows you to create custom borders with multiple color stops and adjustable angles for any design you want."
            }
        }
    ]
}
</script>
{% endblock %}

{% block styles %}
<link rel="stylesheet" href="{{ url_for('static', filename='css/avatar_cropper.css') }}">
<style>
    /* Retro terminal styling for the cropper interface */
    .cropper-terminal {
        background: rgba(0, 0, 0, 0.9);
        border: 2px solid #f97316;
        border-radius: 8px;
        padding: 0.75rem;
        box-shadow: 0 0 20px rgba(249, 115, 22, 0.3);
        font-family: 'VT323', monospace;
        position: relative;
        overflow: hidden;
    }

    .cropper-terminal::before {
        content: '';
        position: absolute;
        top: 0;
        left: 0;
        right: 0;
        bottom: 0;
        background: repeating-linear-gradient(
            0deg,
            rgba(0, 0, 0, 0.1),
            rgba(0, 0, 0, 0.1) 1px,
            transparent 1px,
            transparent 2px
        );
        pointer-events: none;
        animation: scanlines 8s linear infinite;
    }

    .terminal-header {
        color: #fbbf24;
        text-shadow: 0 0 10px #f97316;
        font-size: 1.5rem;
        margin-bottom: 1rem;
        text-align: center;
    }

    .control-panel {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(160px, 1fr));
        gap: 0.5rem;
        margin-bottom: 0.5rem;
    }

    .preview-grid {
        display: flex;
        justify-content: center;
        gap: 1rem;
        flex-wrap: wrap;
        margin-top: 0.5rem;
        align-items: flex-end; /* bottom align for tidy row */
    }

    .preview-item {
        background: transparent;
        border: none;
        padding: 0; /* no frame */
        text-align: center;
        box-shadow: none;
        display: inline-flex;
        flex-direction: column;
        align-items: center;
        min-width: 0; /* override any external min-width */
    }

    .preview-item canvas {
        border-radius: 4px;
        display: block; /* remove extra inline spacing */
    }

    .preview-label {
        color: #fbbf24;
        font-size: 0.8rem; /* slightly smaller */
        margin-top: 0.4rem;
        text-shadow: 0 0 5px #f97316;
    }

    @keyframes scanlines {
        0% { background-position: 0 0; }
        100% { background-position: 0 20px; }
    }
</style>
{% endblock %}

{% block content %}
<div class="container mx-auto px-4 py-8">
    <div class="text-center mb-8">
        <h1 class="text-4xl mb-4 text-white font-vt323 glowing-text">RETRO AVATAR STUDIO</h1>
        <p class="text-gray-300 mb-6 glowing-green-text">Create perfect avatars with 90s arcade precision</p>
    </div>

    <!-- Main Cropper Interface -->
    <div class="cropper-terminal mb-4">
        <div class="terminal-header">
            > AVATAR CROPPER v1.0 - INSERT IMAGE TO BEGIN
        </div>

        <!-- File Upload Prompt (centered in canvas until image selected) -->

        <!-- Cropper Canvas Area -->
        <div class="flex flex-col lg:flex-row gap-3">
            <!-- Main Canvas -->
            <div class="flex-1">
                <div id="cropper-canvas" class="cropper-canvas relative bg-black border-2 border-orange-500 rounded-lg overflow-hidden">
                    <div id="upload-prompt" class="absolute inset-0 flex flex-col items-center justify-center text-center p-4">
                        <label for="image-upload" class="retro-button inline-block cursor-pointer mb-2">SELECT IMAGE FILE</label>
                        <input type="file" id="image-upload" accept="image/*" class="hidden">
                        <p class="text-gray-400 text-sm">or drag & drop your image here</p>
                    </div>
                    <canvas id="main-canvas" class="w-full h-full"></canvas>
                    <div id="drop-overlay" class="absolute inset-0 bg-black bg-opacity-75 flex items-center justify-center text-white text-xl opacity-0 transition-opacity duration-300 pointer-events-none">
                        DROP IMAGE HERE
                    </div>
                </div>
            </div>

            <!-- Control Panel -->
            <div class="lg:w-72">
                <div class="control-panel">
                    <!-- Shape Toggle -->
                    <div class="control-group">
                        <h3 class="control-title">SHAPE</h3>
                        <div class="flex gap-1 justify-center">
                            <button id="shape-circle" class="retro-button-tiny toggled">○</button>
                            <button id="shape-square" class="retro-button-tiny">□</button>
                        </div>
                    </div>

                    <!-- Zoom Controls -->
                    <div class="control-group">
                        <h3 class="control-title">ZOOM</h3>
                        <div class="flex gap-1 justify-center">
                            <button id="zoom-out" class="retro-button-tiny">-</button>
                            <button id="zoom-fit" class="retro-button-tiny">FIT</button>
                            <button id="zoom-in" class="retro-button-tiny">+</button>
                        </div>
                    </div>

                    <!-- Rotation -->
                    <div class="control-group">
                        <h3 class="control-title">ROTATE</h3>
                        <input type="range" id="rotation-slider" min="-180" max="180" value="0" class="w-full">
                        <div class="text-center text-gray-300 text-xs mt-1" id="rotation-value">0°</div>
                    </div>

                    <!-- Flip Controls -->
                    <div class="control-group">
                        <h3 class="control-title">FLIP</h3>
                        <div class="flex gap-1 justify-center">
                            <button id="flip-horizontal" class="retro-button-tiny">↔</button>
                            <button id="flip-vertical" class="retro-button-tiny">↕</button>
                        </div>
                    </div>

                    <!-- Border Options -->
                    <div class="control-group">
                        <h3 class="control-title">BORDERS</h3>
                        <select id="border-select" class="retro-select w-full mb-2 text-sm">
                            <option value="none">None</option>
                            <option value="solid">Solid</option>
                            <option value="retro">Retro</option>
                            <option value="rgb">RGB</option>
                            <option value="custom">Custom</option>
                        </select>
                        <input type="color" id="border-color" class="hidden w-full">
                        <div class="text-center">
                            <input type="range" id="border-size" min="0" max="0.5" step="0.01" value="0.05" class="w-full">
                        </div>
                    </div>

                    <!-- Quick Actions -->
                    <div class="control-group">
                        <h3 class="control-title">ACTIONS</h3>
                        <div class="space-y-1">
                            <button id="center-crop" class="retro-button-tiny w-full">CENTER</button>
                            <button id="fit-crop" class="retro-button-tiny w-full">FIT TO CROP</button>
                            <button id="toggle-lock-center" class="retro-button-tiny w-full">LOCK CENTER (RESIZE)</button>
                            <button id="reset-crop" class="retro-button-tiny w-full">RESET</button>
                            <button id="download-btn" class="retro-button-small w-full text-sm" disabled>DOWNLOAD</button>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Preview Section (hidden until image selected) -->
    <div id="preview-section" class="cropper-terminal mt-2" style="display:none;">
        <div class="terminal-header">
            > PREVIEW SIZES - REAL-TIME RENDERING
        </div>

        <div class="preview-grid" id="preview-grid">
            <!-- Previews will be dynamically generated -->
        </div>

        <div class="text-center mt-6">
            <p class="text-gray-400 text-sm">
                💡 <strong>PRO TIP:</strong> Save as square for Discord avatars, circle for most other platforms
            </p>
        </div>
    </div>
</div>

<!-- Error Console (matching existing tools) -->
<div class="error-console-overlay"></div>
<div class="error-console"></div>

<!-- Gradient Editor Dialog -->
<div class="gradient-editor-overlay" id="gradient-editor-overlay">
    <div class="gradient-editor-dialog">
        <div class="gradient-editor-header">
            <h2>> CUSTOM GRADIENT BORDER EDITOR</h2>
            <button class="gradient-editor-close">❌</button>
        </div>

        <div class="gradient-editor-content">
            <div class="gradient-preview-section">
                <h3>PREVIEW</h3>
                <canvas id="gradient-preview-canvas" width="250" height="250"></canvas>
                <div class="gradient-info">
                    <div id="gradient-stops-count">Stops: 0</div>
                    <div id="gradient-angle-display">Angle: 0°</div>
                </div>
            </div>

            <div class="gradient-controls-section">
                <h3>CONTROLS</h3>

                <div class="control-group">
                    <label>ANGLE</label>
                    <input type="range" id="gradient-angle" min="0" max="360" value="0" step="1">
                    <span id="angle-value">0°</span>
                </div>

                <div class="control-group">
                    <label>GRADIENT STOPS</label>
                    <div id="gradient-stops-list"></div>
                </div>

                <div class="control-group">
                    <div class="button-row">
                        <button id="add-stop-btn" class="retro-button-small">ADD STOP</button>
                        <button id="remove-stop-btn" class="retro-button-small">REMOVE</button>
                    </div>
                    <button id="equidistant-btn" class="retro-button-small">MAKE EQUIDISTANT</button>
                </div>

                <div class="control-group">
                    <label>PRESETS</label>
                    <select id="gradient-presets">
                        <option value="">Select Preset...</option>
                        <option value="rainbow">Rainbow</option>
                        <option value="sunset">Sunset</option>
                        <option value="ocean">Ocean</option>
                        <option value="fire">Fire</option>
                        <option value="forest">Forest</option>
                    </select>
                </div>
            </div>
        </div>

        <div class="gradient-editor-footer">
            <button id="gradient-save-btn" class="retro-button">SAVE GRADIENT</button>
            <button id="gradient-cancel-btn" class="retro-button">CANCEL</button>
        </div>
    </div>
</div>
{% endblock %}

{% block scripts %}
<script src="{{ url_for('static', filename='js/avatar_cropper.js') }}"></script>
{% endblock %}
